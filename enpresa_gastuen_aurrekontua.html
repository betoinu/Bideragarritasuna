<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finantzaketa Estrategia</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        h1 {
            color: var(--primary-color);
            margin-bottom: 25px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }
        
        h2 {
            color: var(--dark-color);
            margin: 25px 0 15px;
            font-size: 1.4rem;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 8px;
            background-color: var(--light-color);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--secondary-color);
            color: white;
        }
        
        tr:hover {
            background-color: #f1f1f1;
        }
        
        .btn {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            text-decoration: none;
            font-size: 16px;
            margin: 5px;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: var(--primary-color);
        }
        
        .btn-danger {
            background: var(--accent-color);
        }
        
        .btn-danger:hover {
            background: #c0392b;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        
        .flex-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .flex-item {
            flex: 1;
            min-width: 300px;
        }
        
        .result-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border-left: 5px solid var(--secondary-color);
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .checkbox-group {
            margin: 10px 0;
        }
        
        .checkbox-group label {
            display: inline-block;
            margin-left: 10px;
            font-weight: normal;
        }
        
        @media (max-width: 768px) {
            .flex-container {
                flex-direction: column;
            }
            
            .flex-item {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>6 · Finantzaketa Estrategia</h1>
        
        <!-- Sección de Socios -->
        <div class="section">
            <h2>Aportaciones de Socios</h2>
            <div class="flex-container">
                <div class="flex-item">
                    <p>Número de socios definidos en la pestaña anterior: <span id="num-socios">3</span></p>
                    <button class="btn" id="add-socio">Añadir Socio</button>
                    <button class="btn btn-danger" id="remove-socio">Eliminar Socio</button>
                </div>
                <div class="flex-item">
                    <table id="socios-table">
                        <thead>
                            <tr>
                                <th>Socio</th>
                                <th>Capital (€)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Bazkide 1</td>
                                <td><input type="number" value="0" min="0" class="capital-input"></td>
                            </tr>
                            <tr>
                                <td>Bazkide 2</td>
                                <td><input type="number" value="0" min="0" class="capital-input"></td>
                            </tr>
                            <tr>
                                <td>Bazkide 3</td>
                                <td><input type="number" value="0" min="0" class="capital-input"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Sección de Gastos -->
        <div class="section">
            <h2>Clasificación de Gastos</h2>
            <div class="flex-container">
                <div class="flex-item">
                    <h3>Gastos Amortizables</h3>
                    <div class="input-group">
                        <label for="gastos-amortizables">Total Gastos Amortizables (€)</label>
                        <input type="number" id="gastos-amortizables" value="0" min="0">
                    </div>
                </div>
                <div class="flex-item">
                    <h3>Gastos Anualizables</h3>
                    <div class="input-group">
                        <label for="gastos-anualizables">Total Gastos Anualizables (€)</label>
                        <input type="number" id="gastos-anualizables" value="0" min="0">
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="financiar-anualizables">
                        <label for="financiar-anualizables">Financiar gastos anualizables para mejorar tesorería</label>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Sección de Socios Capitalistas -->
        <div class="section">
            <h2>Socios Capitalistas</h2>
            <button class="btn" id="add-capitalista">Añadir Socio Capitalista</button>
            <table id="capitalistas-table">
                <thead>
                    <tr>
                        <th>Socio Capitalista</th>
                        <th>Aportación (€)</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Las filas se añadirán dinámicamente -->
                </tbody>
            </table>
        </div>
        
        <!-- Sección de Financiación Externa -->
        <div class="section">
            <h2>Financiación Externa</h2>
            <div class="flex-container">
                <div class="flex-item">
                    <div class="input-group">
                        <label for="necesidades-inversion">Necesidades de Inversión (€)</label>
                        <input type="number" id="necesidades-inversion" value="210127.5" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="tipo-prestamo">Tipo de Préstamo</label>
                        <select id="tipo-prestamo">
                            <option value="standard">Préstamo Estándar</option>
                            <option value="hipotecario">Préstamo Hipotecario</option>
                            <option value="linea-credito">Línea de Crédito</option>
                        </select>
                    </div>
                </div>
                <div class="flex-item">
                    <div class="input-group">
                        <label for="tae">TAE (%)</label>
                        <input type="number" id="tae" value="5" min="0" step="0.01">
                    </div>
                    <div class="input-group">
                        <label for="plazo">Plazo (años)</label>
                        <input type="number" id="plazo" value="5" min="1">
                    </div>
                </div>
            </div>
            
            <!-- Resultados de Cálculo -->
            <div class="result-box">
                <h3>Resumen de Financiación</h3>
                <p>Total Aportado por Socios: <span id="total-socios">0</span> €</p>
                <p>Total Aportado por Socios Capitalistas: <span id="total-capitalistas">0</span> €</p>
                <p>Cantidad a Financiar: <span id="cantidad-financiar">210127.5</span> €</p>
                <p>Cuota Mensual Estimada: <span id="cuota-mensual">0</span> €</p>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let socioCount = 3;
        let capitalistaCount = 0;
        
        // Elementos DOM
        const numSociosSpan = document.getElementById('num-socios');
        const addSocioBtn = document.getElementById('add-socio');
        const removeSocioBtn = document.getElementById('remove-socio');
        const sociosTable = document.getElementById('socios-table');
        const addCapitalistaBtn = document.getElementById('add-capitalista');
        const capitalistasTable = document.getElementById('capitalistas-table');
        
        // Actualizar número de socios (simulando conexión con otra pestaña)
        function updateNumSocios(n) {
            socioCount = n;
            numSociosSpan.textContent = n;
            
            // Actualizar tabla de socios
            const tbody = sociosTable.querySelector('tbody');
            tbody.innerHTML = '';
            
            for (let i = 1; i <= socioCount; i++) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>Bazkide ${i}</td>
                    <td><input type="number" value="0" min="0" class="capital-input"></td>
                `;
                tbody.appendChild(row);
            }
            
            // Recalcular financiación
            calcularFinanciacion();
        }
        
        // Añadir socio
        addSocioBtn.addEventListener('click', () => {
            updateNumSocios(socioCount + 1);
        });
        
        // Eliminar socio
        removeSocioBtn.addEventListener('click', () => {
            if (socioCount > 1) {
                updateNumSocios(socioCount - 1);
            } else {
                alert('Debe haber al menos un socio');
            }
        });
        
        // Añadir socio capitalista
        addCapitalistaBtn.addEventListener('click', () => {
            capitalistaCount++;
            const tbody = capitalistasTable.querySelector('tbody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>Socio Capitalista ${capitalistaCount}</td>
                <td><input type="number" value="0" min="0" class="capitalista-input"></td>
                <td><button class="btn btn-danger remove-capitalista">Eliminar</button></td>
            `;
            tbody.appendChild(row);
            
            // Añadir evento al botón de eliminar
            row.querySelector('.remove-capitalista').addEventListener('click', function() {
                this.closest('tr').remove();
                capitalistaCount--;
                calcularFinanciacion();
            });
            
            // Añadir evento al input
            row.querySelector('.capitalista-input').addEventListener('input', calcularFinanciacion);
            
            // Recalcular financiación
            calcularFinanciacion();
        });
        
        // Calcular financiación
        function calcularFinanciacion() {
            // Calcular total aportado por socios
            let totalSocios = 0;
            document.querySelectorAll('.capital-input').forEach(input => {
                totalSocios += parseFloat(input.value) || 0;
            });
            
            // Calcular total aportado por socios capitalistas
            let totalCapitalistas = 0;
            document.querySelectorAll('.capitalista-input').forEach(input => {
                totalCapitalistas += parseFloat(input.value) || 0;
            });
            
            // Obtener necesidades de inversión
            const necesidadesInversion = parseFloat(document.getElementById('necesidades-inversion').value) || 0;
            
            // Calcular cantidad a financiar
            let cantidadFinanciar = necesidadesInversion - totalSocios - totalCapitalistas;
            
            // Si se selecciona financiar gastos anualizables, añadirlos
            const financiarAnualizables = document.getElementById('financiar-anualizables').checked;
            const gastosAnualizables = parseFloat(document.getElementById('gastos-anualizables').value) || 0;
            
            if (financiarAnualizables) {
                cantidadFinanciar += gastosAnualizables;
            }
            
            // Asegurar que la cantidad a financiar no sea negativa
            cantidadFinanciar = Math.max(0, cantidadFinanciar);
            
            // Calcular cuota mensual (fórmula simplificada)
            const tae = parseFloat(document.getElementById('tae').value) || 0;
            const plazo = parseFloat(document.getElementById('plazo').value) || 1;
            
            const tasaMensual = (tae / 100) / 12;
            const numPagos = plazo * 12;
            
            let cuotaMensual = 0;
            if (tasaMensual > 0) {
                cuotaMensual = cantidadFinanciar * tasaMensual * Math.pow(1 + tasaMensual, numPagos) / 
                              (Math.pow(1 + tasaMensual, numPagos) - 1);
            } else {
                cuotaMensual = cantidadFinanciar / numPagos;
            }
            
            // Actualizar la interfaz
            document.getElementById('total-socios').textContent = totalSocios.toFixed(2);
            document.getElementById('total-capitalistas').textContent = totalCapitalistas.toFixed(2);
            document.getElementById('cantidad-financiar').textContent = cantidadFinanciar.toFixed(2);
            document.getElementById('cuota-mensual').textContent = cuotaMensual.toFixed(2);
        }
        
        // Añadir eventos a los inputs para recalcular financiación
        document.getElementById('necesidades-inversion').addEventListener('input', calcularFinanciacion);
        document.getElementById('tae').addEventListener('input', calcularFinanciacion);
        document.getElementById('plazo').addEventListener('input', calcularFinanciacion);
        document.getElementById('gastos-amortizables').addEventListener('input', calcularFinanciacion);
        document.getElementById('gastos-anualizables').addEventListener('input', calcularFinanciacion);
        document.getElementById('financiar-anualizables').addEventListener('change', calcularFinanciacion);
        
        // Inicializar
        updateNumSocios(3);
        calcularFinanciacion();
    </script>
</body>
</html>
