<!doctype html>
<html lang="eu">
<head>
    <link rel="icon" type="image/x-icon" href="favicon.ico" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>IDarte · Enpresa Gastuen Aurrekontua</title>
    <link rel="stylesheet" href="css/style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="wrap" role="application" aria-label="IDarte presupuesto adaptado">
        <!-- CABECERA -->
<header class="brand" role="banner">
    <div class="logo">
        <img src="img/mi_nueva_textura_idarte.svg" alt="IDarte logotipo" class="idarte-logo">
    </div>
    <div class="meta">
        <h1><span data-i18n="header.title">IDarte · Euskadiko Diseinu Eskola Publikoa</span></h1>
        <p class="muted"><span data-i18n="header.subtitle">BARNE DISEINU GRADUA - Neurketak eta Aurrekontuak</span></p>
    </div>
    <div class="controls">
        <select id="language-select">
            <option value="eu">Euskera</option>
            <option value="es">Español</option>
            <option value="en">English</option>
        </select>
        <button class="btn primary" id="download-report-btn" data-i18n="button.download" onclick="generatePDFReport()">Deskargatu</button>
    </div>
</header>


        <!-- CUERPO PRINCIPAL -->
        <main class="stage">
            <section class="stage-left" id="main-sheet">
                <!-- TABS -->
<div class="tabs" role="tablist">
    <button class="tab active"><span data-i18n="tab.lokal">1 · Lokal</span></button>
    <button class="tab"><span data-i18n="tab.pertsonala">2 · Pertsonala</span></button>
    <button class="tab"><span data-i18n="tab.ekoizpena">3 · Ekoizpena</span></button>
    <button class="tab"><span data-i18n="tab.garraioa">4 · Garraioa</span></button>
    <button class="tab"><span data-i18n="tab.hazkuntza">5 · Hazkuntza</span></button>
    <button class="tab"><span data-i18n="tab.finantzaketa">6 · Finantzaketa</span></button>
    <button class="tab"><span data-i18n="tab.prezioa">7 · Prezioa</span></button>
</div>

               <!-- PANEL 1 - LOKALA -->
<div id="lokala-sheet" class="panel">
    <h2 data-i18n="panel.lokal.title">1 · Lokalaren Gastu Finkoak eta Inbertsioak</h2>
    
    <h3 data-i18n="panel.lokal.amortizables">A) Inbertsio amortizagarriak</h3>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.concepto">Kontzeptua</th>
                <th data-i18n="table.coste">Kostua (€)</th>
                <th data-i18n="table.amortizacion">Amortizazio Urteak</th>
                <th data-i18n="table.amortizacionAnual">Urteko Amortizazioa</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="lokala-amortizable-body"></tbody>
    </table>
    <button class="btn small" onclick="addAmortizable('lokala')" data-i18n="button.addAmortizable">+ Gehitu</button>

    <h3 data-i18n="panel.lokal.gastos">B) Gastu finkoak</h3>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.concepto">Kontzeptua</th>
                <th data-i18n="table.coste">Kostua (€)</th>
                <th data-i18n="table.frecuencia">Maiztasuna</th>
                <th data-i18n="table.totalAnual">Urteko Guztira</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="lokala-recurring-body"></tbody>
    </table>
    <button class="btn small" onclick="addRecurring('lokala')" data-i18n="button.addRecurring">+ Gehitu</button>
</div>

<!-- PANEL 2 - PERTSONALA -->
<div id="pertsonala-sheet" class="panel" style="display:none">
    <h2 data-i18n="panel.pertsonala.title">2 · Pertsonalaren Gastuak</h2>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.lanpostua">Lanpostua</th>
                <th data-i18n="table.soldata">Urteko Soldata Gordina</th>
                <th data-i18n="table.gizarteSegurantza">Gizarte Segurantza (%)</th>
                <th data-i18n="table.guztira">Guztira</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="personnel-body"></tbody>
    </table>
    <button class="btn small" onclick="addPerson()" data-i18n="button.addPerson">+ Gehitu Langilea</button>
</div>

                <!-- PANEL 3 - EKOIZPENA -->
<div id="ekoizpena-sheet" class="panel" style="display:none">
    <h2 data-i18n="panel.ekoizpena.title">3 · Ekoizpen Gastuak</h2>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.concepto">Kontzeptua</th>
                <th data-i18n="table.coste">Kostua (€)</th>
                <th data-i18n="table.frecuencia">Maiztasuna</th>
                <th data-i18n="table.totalAnual">Urteko Guztira</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="ekoizpena-recurring-body"></tbody>
    </table>
    <button class="btn small" onclick="addRecurring('ekoizpena')" data-i18n="button.addRecurring">+ Gehitu Gastua</button>
</div>

<!-- PANEL 4 - GARRAIOA -->
<div id="garraioa-sheet" class="panel" style="display:none">
    <h2 data-i18n="panel.garraioa.title">4 · Garraio eta Logistika Gastuak</h2>
    
    <h3 data-i18n="panel.garraioa.amortizables">A) Inbertsio amortizagarriak</h3>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.concepto">Kontzeptua</th>
                <th data-i18n="table.coste">Kostua (€)</th>
                <th data-i18n="table.amortizacion">Amortizazio Urteak</th>
                <th data-i18n="table.amortizacionAnual">Urteko Amortizazioa</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="garraioa-amortizable-body"></tbody>
    </table>
    <button class="btn small" onclick="addAmortizable('garraioa')" data-i18n="button.addAmortizable">+ Gehitu Inbertsioa</button>

    <h3 data-i18n="panel.garraioa.gastos">B) Gastu finkoak</h3>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.concepto">Kontzeptua</th>
                <th data-i18n="table.coste">Kostua (€)</th>
                <th data-i18n="table.frecuencia">Maiztasuna</th>
                <th data-i18n="table.totalAnual">Urteko Guztira</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="garraioa-recurring-body"></tbody>
    </table>
    <button class="btn small" onclick="addRecurring('garraioa')" data-i18n="button.addRecurring">+ Gehitu Gastua</button>
</div>

<!-- PANEL 5 - HAZKUNTZA -->
<div id="hazkuntza-sheet" class="panel" style="display:none">
    <h2 data-i18n="panel.hazkuntza.title">5 · Hazkuntza eta Garapen Gastuak</h2>
    <table class="data">
        <thead>
            <tr>
                <th data-i18n="table.concepto">Kontzeptua</th>
                <th data-i18n="table.coste">Kostua (€)</th>
                <th data-i18n="table.frecuencia">Maiztasuna</th>
                <th data-i18n="table.totalAnual">Urteko Guztira</th>
                <th data-i18n="table.ekintzak">Ekintzak</th>
            </tr>
        </thead>
        <tbody id="hazkuntza-recurring-body"></tbody>
    </table>
    <button class="btn small" onclick="addRecurring('hazkuntza')" data-i18n="button.addRecurring">+ Gehitu Gastua</button>
</div>

<!-- PANEL 6 - FINANTZAKETA (ya lo tenías, pero lo mantengo para completitud) -->
<div id="finantzaketa-sheet" class="panel" style="display:none">
    <h2 data-i18n="panel.finantzaketa.title">6 · Finantzaketa Estrategia</h2>
    
    <!-- ... contenido del panel 6 que ya tenías ... -->
</div>

<!-- PANEL 7 - PREZIOA -->
<div id="prezioa-sheet" class="panel" style="display:none">
    <h2 data-i18n="panel.prezioa.title">7 · Lanorduaren Prezioa eta Mozkinak</h2>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
        <div>
            <label for="corporate-tax" data-i18n="pricing.sozietateZerga">Sozietateen Zerga (%)</label>
            <input id="corporate-tax" type="number" value="25" oninput="actualizarCascada()" />
            
            <label for="target-profit-margin" data-i18n="pricing.mozkinMargina">Helburuko Mozkin Gordina (%)</label>
            <input id="target-profit-margin" type="number" value="20" oninput="actualizarCascada()" />
            
            <label for="employee-count" data-i18n="pricing.langileKopurua">Langile kopurua</label>
            <input id="employee-count" type="number" value="2" oninput="actualizarCascada()" />
            
            <label for="annual-hours-per-employee" data-i18n="pricing.urtekoOrduak">Urteko orduak/lang</label>
            <input id="annual-hours-per-employee" type="number" value="1600" oninput="actualizarCascada()" />
        </div>
        <div>
            <!-- DESGLOSE PEDAGÓGICO -->
            <div class="card" style="background:#f8f9fa">
                <h4 data-i18n="pricing.nolaKalkulatzen">Nola kalkulatzen da orduko prezioa?</h4>
                <div class="desglose-pedagogico">
                    <div class="desglose-linea">
                        <span data-i18n="pricing.gastuOperatiboak">Gastu Operatiboak:</span>
                        <span id="desglose-gastos-operativos">€ 0.00</span>
                    </div>
                    <div class="desglose-linea">
                        <span data-i18n="pricing.finantzaketaKostuak">+ Finantzaketa Kostuak:</span>
                        <span id="desglose-costes-financieros">€ 0.00</span>
                    </div>
                    <div class="desglose-linea" style="border-top:1px solid #ddd;padding-top:8px">
                        <span><strong data-i18n="pricing.gastuTotalak">Gastu Totalak:</strong></span>
                        <span id="desglose-gastos-totales"><strong>€ 0.00</strong></span>
                    </div>
                    <div class="desglose-linea">
                        <span data-i18n="pricing.mozkinGordinaPorcentaje">+ Mozkin Gordina (<span id="desglose-porcentaje-margen">20</span>%):</span>
                        <span id="desglose-margen-bruto">€ 0.00</span>
                    </div>
                    <div class="desglose-linea" style="border-top:1px solid #ddd;padding-top:8px">
                        <span><strong data-i18n="pricing.fakturazioTotala">Fakturazio Totala:</strong></span>
                        <span id="desglose-facturacion-total"><strong>€ 0.00</strong></span>
                    </div>
                    <div class="desglose-linea">
                        <span data-i18n="pricing.urtekoOrduakDivision">÷ Urteko Orduak (<span id="desglose-total-horas">0</span>h):</span>
                        <span></span>
                    </div>
                    <div class="desglose-linea" style="border-top:2px solid #333;padding-top:8px">
                        <span><strong data-i18n="pricing.ordukoPrezioa">Orduko Prezioa:</strong></span>
                        <span id="desglose-precio-hora"><strong>€ 0.00</strong></span>
                    </div>
                </div>
            </div>

            <!-- RESUMEN ACTUAL -->
            <div class="card">
                <h4 data-i18n="pricing.gomendatutakoPrezioa">Gomendatutako orduko prezioa</h4>
                <p id="suggested-hourly-rate" class="value">€ 0.00</p>
            </div>
            <div class="card">
                <h4 data-i18n="pricing.mozkinGordina">Mozkin Gordina (Zergak aurre)</h4>
                <p id="margen-bruto-panel7" class="value">€ 0.00</p>
            </div>
            <div class="card">
                <h4 data-i18n="pricing.mozkinGarbia">Espero den mozkin garbia</h4>
                <p id="expected-net-profit" class="value">€ 0.00</p>
            </div>
            <div class="card">
                <h4 data-i18n="pricing.fakturazioBeharrezkoa">Fakturazio beharrezkoa</h4>
                <p id="required-annual-revenue" class="value">€ 0.00</p>
            </div>
        </div>
    </div>
</div>
      <!-- SIDEBAR -->
<aside class="sidebar">
    <div class="card">
        <h4 data-i18n="sidebar.facturacion">Urteko Fakturazioa Beharrezkoa</h4>
        <p id="total-facturacion" class="value">€ 0.00</p>
        <div class="facturacion-desglose">
            <div class="desglose-item">
                <span class="desglose-label" data-i18n="sidebar.gastuOperatiboak">Gastu Operatiboak:</span>
                <span id="gastos-operativos" class="desglose-value">€ 0.00</span>
            </div>
            <div class="desglose-item">
                <span class="desglose-label" data-i18n="sidebar.finantzaketaKostuak">Finantzaketa Kostuak (Kuota Anuala):</span>
                <span id="costos-financieros" class="desglose-value">€ 0.00</span>
            </div>
            <div class="desglose-item">
                <span class="desglose-label" data-i18n="sidebar.mozkinGordina">Mozkin Gordina:</span>
                <span id="margen-bruto" class="desglose-value">€ 0.00</span>
            </div>
        </div>
    </div>

    <div class="card">
        <h4 data-i18n="sidebar.precioHora">Gomendatutako Orduko Prezioa</h4>
        <p id="suggested-hourly-rate-sidebar" class="value">€ 0.00</p>
        <p class="muted" data-i18n="sidebar.langileKopurua">Langile kopurua: <span id="employee-count-sidebar">0</span></p>
        <p class="muted" data-i18n="sidebar.urtekoOrduak">Urteko orduak: <span id="annual-hours-sidebar">0</span></p>
    </div>

    <div class="card">
        <h4 data-i18n="sidebar.resumenCostes">Kostuen Laburpena</h4>
        <div class="cost-breakdown">
            <div class="cost-item">
                <span data-i18n="sidebar.amortizazioak">Amortizazioak:</span>
                <span id="total-amortizaciones">€ 0.00</span>
            </div>
            <div class="cost-item">
                <span data-i18n="sidebar.gastuFinkoak">Gastu Finkoak:</span>
                <span id="total-gastos-fijos">€ 0.00</span>
            </div>
            <div class="cost-item">
                <span data-i18n="sidebar.pertsonala">Pertsonala:</span>
                <span id="total-personal">€ 0.00</span>
            </div>
            <div class="cost-item">
                <span data-i18n="sidebar.finantzaketaGuztira">Finantzaketa Guztira:</span>
                <span id="total-intereses">€ 0.00</span>
            </div>
        </div>
    </div>

    <div class="card contact-card">
        <h4 data-i18n="contact.title">Kontaktua</h4>
        <p class="muted" data-i18n="contact.name">Josu Ayerbe Guarás, Barne Diseinuko Graduko irakaslea</p>
        <p class="muted" data-i18n="contact.email">josuayerbe@idarte.eus</p>
        <p class="muted" data-i18n="contact.address">Portal de Betoño, 23 · Vitoria-Gasteiz</p>
    </div>
</aside>

<!-- FOOTER -->
<footer class="siteinfo">
    <small data-i18n="footer.note">IDarte · Euskadiko Diseinu Eskola Publikoa — Escuela Pública de Diseño de Euskadi.</small>
</footer>

    <!-- Overlay de carga -->
    <div id="loading-overlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;z-index:9999">
        <div style="background:white;padding:20px;border-radius:8px;display:flex;flex-direction:column;align-items:center">
            <div style="width:48px;height:48px;border:6px solid #eee;border-top-color:var(--id-primary);border-radius:50%;animation:spin 1s linear infinite"></div>
            <p style="margin-top:12px;color:#111827" data-i18n="loading">Txostena prestatzen...</p>
        </div>
    </div>
    <style>
        @keyframes spin {
            to {
                transform: rotate(360deg)
            }
        }
    </style>
    <script src="js/logic.js"></script>
</body>
</html>
